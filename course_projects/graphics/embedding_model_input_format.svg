<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 900">
  <!-- Background -->
  <rect width="900" height="900" fill="#f8f9fa" rx="10" ry="10"/>
  <text x="450" y="40" font-family="Arial" font-size="24" text-anchor="middle" font-weight="bold" fill="#333">Input Format for Word Embedding Model</text>
  
  <!-- Raw Input Section -->
  <rect x="50" y="70" width="800" height="130" rx="10" ry="10" fill="#e3f2fd" stroke="#90caf9" stroke-width="2"/>
  <text x="450" y="90" font-family="Arial" font-size="18" text-anchor="middle" font-weight="bold" fill="#1565c0">Raw Input Example</text>
  
  <!-- Question -->
  <rect x="70" y="110" width="400" height="40" rx="5" ry="5" fill="#bbdefb" stroke="#64b5f6" stroke-width="1"/>
  <text x="90" y="133" font-family="Arial" font-size="14" fill="#0d47a1" font-weight="bold">Question:</text>
  <text x="160" y="133" font-family="Arial" font-size="14" fill="#0d47a1">Where would you find a guitar?</text>
  
  <!-- Choices -->
  <rect x="70" y="160" width="760" height="30" rx="5" ry="5" fill="#bbdefb" stroke="#64b5f6" stroke-width="1"/>
  <text x="90" y="180" font-family="Arial" font-size="14" fill="#0d47a1" font-weight="bold">Choices:</text>
  <text x="160" y="180" font-family="Arial" font-size="14" fill="#0d47a1">A) Band B) Restaurant C) School D) Field E) Store</text>
  
  <!-- Tokenization Section -->
  <rect x="50" y="220" width="800" height="260" rx="10" ry="10" fill="#e8f5e9" stroke="#a5d6a7" stroke-width="2"/>
  <text x="450" y="240" font-family="Arial" font-size="18" text-anchor="middle" font-weight="bold" fill="#2e7d32">Step 1: Tokenization with NLTK</text>
  
  <!-- Question Tokenization - with increased bottom padding -->
  <rect x="70" y="260" width="360" height="120" rx="5" ry="5" fill="#c8e6c9" stroke="#81c784" stroke-width="1"/>
  <text x="90" y="280" font-family="Arial" font-size="14" fill="#1b5e20" font-weight="bold">Question Tokens:</text>
  
  <!-- Token boxes for question -->
  <rect x="90" y="290" width="60" height="30" rx="5" ry="5" fill="#f1f8e9" stroke="#aed581" stroke-width="1"/>
  <text x="120" y="310" font-family="Arial" font-size="12" text-anchor="middle" fill="#33691e">"Where"</text>
  
  <rect x="160" y="290" width="60" height="30" rx="5" ry="5" fill="#f1f8e9" stroke="#aed581" stroke-width="1"/>
  <text x="190" y="310" font-family="Arial" font-size="12" text-anchor="middle" fill="#33691e">"would"</text>
  
  <rect x="230" y="290" width="60" height="30" rx="5" ry="5" fill="#f1f8e9" stroke="#aed581" stroke-width="1"/>
  <text x="260" y="310" font-family="Arial" font-size="12" text-anchor="middle" fill="#33691e">"you"</text>
  
  <rect x="300" y="290" width="60" height="30" rx="5" ry="5" fill="#f1f8e9" stroke="#aed581" stroke-width="1"/>
  <text x="330" y="310" font-family="Arial" font-size="12" text-anchor="middle" fill="#33691e">"find"</text>
  
  <rect x="90" y="330" width="60" height="30" rx="5" ry="5" fill="#f1f8e9" stroke="#aed581" stroke-width="1"/>
  <text x="120" y="350" font-family="Arial" font-size="12" text-anchor="middle" fill="#33691e">"a"</text>
  
  <rect x="160" y="330" width="60" height="30" rx="5" ry="5" fill="#f1f8e9" stroke="#aed581" stroke-width="1"/>
  <text x="190" y="350" font-family="Arial" font-size="12" text-anchor="middle" fill="#33691e">"guitar"</text>
  
  <rect x="230" y="330" width="60" height="30" rx="5" ry="5" fill="#f1f8e9" stroke="#aed581" stroke-width="1"/>
  <text x="260" y="350" font-family="Arial" font-size="12" text-anchor="middle" fill="#33691e">"?"</text>
  
  <!-- Choices Tokenization - all in a consistent layout, with Choice D moved to right side -->
  <!-- Choice A -->
  <rect x="480" y="260" width="340" height="35" rx="5" ry="5" fill="#c8e6c9" stroke="#81c784" stroke-width="1"/>
  <text x="500" y="285" font-family="Arial" font-size="14" fill="#1b5e20" font-weight="bold">Choice A Tokens:</text>
  <rect x="620" y="265" width="60" height="27" rx="5" ry="5" fill="#f1f8e9" stroke="#aed581" stroke-width="1"/>
  <text x="650" y="285" font-family="Arial" font-size="12" text-anchor="middle" fill="#33691e">"Band"</text>
  
  <!-- Choice B -->
  <rect x="480" y="305" width="340" height="35" rx="5" ry="5" fill="#c8e6c9" stroke="#81c784" stroke-width="1"/>
  <text x="500" y="330" font-family="Arial" font-size="14" fill="#1b5e20" font-weight="bold">Choice B Tokens:</text>
  <rect x="620" y="310" width="95" height="27" rx="5" ry="5" fill="#f1f8e9" stroke="#aed581" stroke-width="1"/>
  <text x="680" y="330" font-family="Arial" font-size="12" dx="-50"  fill="#33691e">"Restaurant"</text>
  
  <!-- Choice C -->
  <rect x="480" y="350" width="340" height="35" rx="5" ry="5" fill="#c8e6c9" stroke="#81c784" stroke-width="1"/>
  <text x="500" y="375" font-family="Arial" font-size="14" fill="#1b5e20" font-weight="bold">Choice C Tokens:</text>
  <rect x="620" y="355" width="60" height="27" rx="5" ry="5" fill="#f1f8e9" stroke="#aed581" stroke-width="1"/>
  <text x="650" y="375" font-family="Arial" font-size="12" text-anchor="middle" fill="#33691e">"School"</text>
  
  <!-- Choice D - moved to right side -->
  <rect x="480" y="395" width="340" height="35" rx="5" ry="5" fill="#c8e6c9" stroke="#81c784" stroke-width="1"/>
  <text x="500" y="420" font-family="Arial" font-size="14" fill="#1b5e20" font-weight="bold">Choice D Tokens:</text>
  <rect x="620" y="400" width="60" height="27" rx="5" ry="5" fill="#f1f8e9" stroke="#aed581" stroke-width="1"/>
  <text x="650" y="420" font-family="Arial" font-size="12" text-anchor="middle" fill="#33691e">"Field"</text>
  
  <!-- Choice E -->
  <rect x="480" y="440" width="340" height="35" rx="5" ry="5" fill="#c8e6c9" stroke="#81c784" stroke-width="1"/>
  <text x="500" y="465" font-family="Arial" font-size="14" fill="#1b5e20" font-weight="bold">Choice E Tokens:</text>
  <rect x="620" y="445" width="60" height="27" rx="5" ry="5" fill="#f1f8e9" stroke="#aed581" stroke-width="1"/>
  <text x="650" y="465" font-family="Arial" font-size="12" text-anchor="middle" fill="#33691e">"Store"</text>
  
  <!-- Word Embeddings Section -->
  <rect x="50" y="500" width="800" height="120" rx="10" ry="10" fill="#fff3e0" stroke="#ffcc80" stroke-width="2"/>
  <text x="450" y="520" font-family="Arial" font-size="18" text-anchor="middle" font-weight="bold" fill="#e65100">Step 2: Convert to FastText Word Embeddings</text>
  
  <!-- Word vector visualization -->
  <rect x="70" y="540" width="740" height="70" rx="5" ry="5" fill="#ffe0b2" stroke="#ffb74d" stroke-width="1"/>
  <text x="90" y="560" font-family="Arial" font-size="14" fill="#e65100" font-weight="bold">For each token → FastText word vector:</text>
  
  <!-- Sample vector visualization -->
  <rect x="90" y="570" width="380" height="30" rx="5" ry="5" fill="#fff8e1" stroke="#ffe082" stroke-width="1"/>
  <text x="110" y="590" font-family="Arial" font-size="12" fill="#ff6f00">"guitar" → [0.12, -0.45, 0.78, ... 297 more values] (300-dim vector)</text>
  
  <text x="500" y="590" font-family="Arial" font-size="14" fill="#e65100" font-style="italic">Every word maps to a 300-dimensional vector</text>
  
  <!-- Averaging Section -->
  <rect x="50" y="640" width="800" height="150" rx="10" ry="10" fill="#f3e5f5" stroke="#ce93d8" stroke-width="2"/>
  <text x="450" y="660" font-family="Arial" font-size="18" text-anchor="middle" font-weight="bold" fill="#4a148c">Step 3: Average Word Vectors</text>
  
  <!-- Question averaging -->
  <rect x="70" y="680" width="340" height="90" rx="5" ry="5" fill="#e1bee7" stroke="#ba68c8" stroke-width="1"/>
  <text x="90" y="700" font-family="Arial" font-size="14" fill="#4a148c" font-weight="bold">Question Representation:</text>
  <text x="90" y="725" font-family="Arial" font-size="12" fill="#4a148c">Average of 7 word vectors → 1 vector</text>
  <text x="90" y="745" font-family="Arial" font-size="12" fill="#4a148c" font-weight="bold">Question Tensor Shape: (batch_size, 300)</text>
  
  <!-- Choices averaging -->
  <rect x="470" y="680" width="340" height="90" rx="5" ry="5" fill="#e1bee7" stroke="#ba68c8" stroke-width="1"/>
  <text x="490" y="700" font-family="Arial" font-size="14" fill="#4a148c" font-weight="bold">5 Choices Representation:</text>
  <text x="490" y="725" font-family="Arial" font-size="12" fill="#4a148c">Each choice: Average of its token vectors → 1 vector</text>
  <text x="490" y="745" font-family="Arial" font-size="12" fill="#4a148c" font-weight="bold">Choices Tensor Shape: (batch_size, 5, 300)</text>
  
  <!-- Simplified Forward Pass Section -->
  <rect x="50" y="810" width="800" height="70" rx="10" ry="10" fill="#e8eaf6" stroke="#9fa8da" stroke-width="2"/>
  <text x="450" y="830" font-family="Arial" font-size="18" text-anchor="middle" font-weight="bold" fill="#283593">Step 4: Forward Pass Through Model</text>
  <text x="450" y="860" font-family="Arial" font-size="16" text-anchor="middle" fill="#1a237e">Question and choices processed through neural network</text>
  
  <!-- Connecting Arrows -->
  <path d="M450,200 L450,220" fill="none" stroke="#666" stroke-width="2" stroke-dasharray="5,5"/>
  <polygon points="450,220 445,210 455,210" fill="#666"/>
  
  <path d="M450,480 L450,500" fill="none" stroke="#666" stroke-width="2" stroke-dasharray="5,5"/>
  <polygon points="450,500 445,490 455,490" fill="#666"/>
  
  <path d="M450,620 L450,640" fill="none" stroke="#666" stroke-width="2" stroke-dasharray="5,5"/>
  <polygon points="450,640 445,630 455,630" fill="#666"/>
  
  <path d="M450,790 L450,810" fill="none" stroke="#666" stroke-width="2" stroke-dasharray="5,5"/>
  <polygon points="450,810 445,800 455,800" fill="#666"/>
</svg>